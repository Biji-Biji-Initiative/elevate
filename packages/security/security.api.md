## API Report File for "@elevate/security"

> Do not edit this file. It is a report generated by [API Extractor](https://api-extractor.com/).

```ts

import type { NextMiddleware } from 'next/server';
import { NextRequest } from 'next/server';
import { NextResponse } from 'next/server';
import { z } from 'zod';

// @public (undocumented)
export const adminRateLimiter: RateLimiter;

// @public (undocumented)
export const apiRateLimiter: RateLimiter;

// @public
export function applySecurityHeaders(response: Response, options?: CSPOptions): Response;

// @public (undocumented)
export const authRateLimiter: RateLimiter;

// @public
export function buildCSPDirectives(options?: CSPOptions): string;

// @public (undocumented)
export const cleanupUtils: {
    forceCleanup: () => void;
    destroy: () => void;
    getStats: () => {
        storeSize: number;
        statsSize: number;
        lastCleanup: number;
        isDestroyed: boolean;
    };
};

// @public
export function containsDangerousContent(content: string): boolean;

// @public
export const CONTENT_LIMITS: {
    readonly SHORT_TEXT: 255;
    readonly MEDIUM_TEXT: 1000;
    readonly LONG_TEXT: 5000;
    readonly URL: 2048;
    readonly EMAIL: 254;
    readonly PHONE: 20;
};

// @public
export class ContentValidationError extends Error {
    constructor(message: string, field: string, value: string);
    // (undocumented)
    readonly field: string;
    // (undocumented)
    readonly value: string;
}

// @public
export function createCSPMiddleware(options?: Omit<CSPOptions, 'nonce'>): (request: NextRequest, response: Response) => Response;

// @public
export function createCSPReportHandler(options?: {
    logToConsole?: boolean;
    logToDB?: boolean;
    alertOnSeverity?: 'low' | 'medium' | 'high';
    onViolation?: (violation: Record<string, unknown> & {
        severity?: 'low' | 'medium' | 'high';
    }) => void;
}): (request: NextRequest) => Promise<NextResponse>;

// @public
export function createNonceMetaTag(nonce: string): string;

// @public
export function createSanitizedEmailSchema(): z.ZodEffects<z.ZodString, string, string>;

// @public
export function createSanitizedStringSchema(maxLength?: number, allowEmpty?: boolean): z.ZodEffects<z.ZodString, string, string>;

// @public
export function createSanitizedUrlSchema(): z.ZodEffects<z.ZodString, string, string>;

// @public
export function createSecurityMiddleware(options?: SecurityMiddlewareOptions): NextMiddleware;

// @public (undocumented)
export interface CSPOptions {
    // (undocumented)
    allowedDomains?: {
        clerk?: string[];
        supabase?: string[];
        fonts?: string[];
        images?: string[];
        analytics?: string[];
        external?: string[];
    };
    // (undocumented)
    isDevelopment?: boolean;
    // (undocumented)
    nonce?: string;
    // (undocumented)
    reportOnly?: boolean;
    // (undocumented)
    reportUri?: string;
}

// @public
export interface CSPViolationReport {
    // (undocumented)
    'csp-report': {
        'document-uri': string;
        'referrer': string;
        'violated-directive': string;
        'effective-directive': string;
        'original-policy': string;
        'blocked-uri': string;
        'line-number'?: number;
        'column-number'?: number;
        'source-file'?: string;
        'status-code'?: number;
    };
}

// @public (undocumented)
export const CSRF_COOKIE_NAME = "_csrf";

// @public (undocumented)
export const CSRF_SECRET_HEADER = "X-CSRF-Secret";

// @public (undocumented)
export const CSRF_TOKEN_HEADER = "X-CSRF-Token";

// @public (undocumented)
export class CSRFError extends Error {
    constructor(message?: string);
    // (undocumented)
    readonly name = "CSRFError";
    // (undocumented)
    readonly status = 403;
}

// @public (undocumented)
export class CSRFManager {
    // Warning: (ae-forgotten-export) The symbol "CsrfConfig" needs to be exported by the entry point index.d.ts
    constructor(config?: CsrfConfig);
    generateSingleToken(): string;
    generateToken(): string;
    generateTokenForResponse(): Promise<{
        token: string;
        response: NextResponse;
    }>;
    generateTokenPair(): {
        secret: string;
        token: string;
    };
    getCsrfCookie(request: NextRequest): string | null;
    getCsrfToken(request: NextRequest): Promise<string | null>;
    middleware(): (request: NextRequest) => Promise<NextResponse | null>;
    setCsrfCookie(response: NextResponse, secret: string): void;
    validateRequest(request: NextRequest): Promise<boolean>;
    validateSingleToken(singleToken: string): boolean;
    validateTokenPair(secret: string, token: string): boolean;
}

// @public (undocumented)
export const csrfManager: CSRFManager;

// @public
export function escapeHtml(input: string): string;

// @public
export function extractCSRFToken(request: NextRequest): Promise<string | null>;

// @public
export function extractNonce(request: NextRequest): string | null;

// @public (undocumented)
export const fileUploadRateLimiter: RateLimiter;

// @public
export function generateCSRFToken(): Promise<string>;

// @public
export function generateNonce(): string;

// @public
export function generateSecurityHeaders(options?: CSPOptions): SecurityHeaders;

// @public
export function getNonceFromRequest(request: NextRequest | Request): string | undefined;

// Warning: (ae-forgotten-export) The symbol "RateLimitCounter" needs to be exported by the entry point index.d.ts
//
// @public (undocumented)
export function getRateLimitStats(): Record<string, RateLimitCounter>;

// @public
export function getSecurityConfig(environment?: string): SecurityMiddlewareOptions;

// @public (undocumented)
export const memoryUtils: {
    getMemoryUsage(): {
        storeSize: number;
        statsSize: number;
        cleanupStats: ReturnType<typeof cleanupManager.getStats>;
        estimatedMemoryKB: number;
    };
    forceCleanup: () => void;
    clearAll(): void;
    getExpiringEntries(withinMs?: number): Array<{
        key: string;
        expiresIn: number;
    }>;
};

// @public
export function processCSPViolation(report: CSPViolationReport): {
    severity: 'low' | 'medium' | 'high';
    action: 'ignore' | 'log' | 'alert';
    reason: string;
};

// @public (undocumented)
export const publicApiRateLimiter: RateLimiter;

// @public (undocumented)
export class RateLimiter {
    // Warning: (ae-forgotten-export) The symbol "RateLimiterConfig" needs to be exported by the entry point index.d.ts
    constructor(config: RateLimiterConfig);
    // (undocumented)
    checkLimit(request: NextRequest): Promise<{
        allowed: boolean;
        remaining: number;
        resetTime: number;
        totalRequests: number;
    }>;
    // (undocumented)
    clearCache(): void;
    // (undocumented)
    createMiddleware(): (request: NextRequest) => Promise<NextResponse | null>;
    // (undocumented)
    getMemoryStats(): {
        name: string;
        lastUsed: number;
        storeSize: number;
        config: {
            windowMs: number;
            maxRequests: number;
        };
    };
}

// @public
export function requiresCSRFProtection(request: NextRequest): boolean;

// @public (undocumented)
export function resetRateLimitStats(): void;

// @public
export function sanitizeBatch(inputs: Record<string, string>, options?: SanitizeOptions): Record<string, string>;

// @public
export function sanitizeEmail(email: string): string | null;

// @public
export interface SanitizeOptions {
    // (undocumented)
    allowedTags?: string[];
    // (undocumented)
    allowNewlines?: boolean;
    // (undocumented)
    allowUrls?: boolean;
    // (undocumented)
    maxLength?: number;
    // (undocumented)
    preserveSpaces?: boolean;
}

// @public
export function sanitizePhone(phone: string): string | null;

// @public
export function sanitizeSubmissionPayload(activityCode: string, payload: Record<string, unknown>): Record<string, unknown>;

// @public
export function sanitizeText(input: string, options?: SanitizeOptions): string;

// @public
export function sanitizeUrl(url: string): string | null;

// @public
export function sanitizeUrls(text: string): string;

// @public
export function sanitizeUserProfile(data: {
    name?: string;
    handle?: string;
    school?: string;
    bio?: string;
    website?: string;
}): {
    name?: string;
    handle?: string;
    school?: string;
    bio?: string;
    website?: string;
};

// @public
export const securityConfig: {
    development: SecurityMiddlewareOptions;
    staging: SecurityMiddlewareOptions;
    production: SecurityMiddlewareOptions;
};

// @public (undocumented)
export interface SecurityHeaders {
    // (undocumented)
    'Content-Security-Policy'?: string;
    // (undocumented)
    'Content-Security-Policy-Report-Only'?: string;
    // (undocumented)
    'Cross-Origin-Embedder-Policy'?: string;
    // (undocumented)
    'Cross-Origin-Opener-Policy'?: string;
    // (undocumented)
    'Cross-Origin-Resource-Policy'?: string;
    // (undocumented)
    'Permissions-Policy': string;
    // (undocumented)
    'Referrer-Policy': string;
    // (undocumented)
    'Strict-Transport-Security'?: string;
    // (undocumented)
    'X-Content-Type-Options': string;
    // (undocumented)
    'X-DNS-Prefetch-Control': string;
    // (undocumented)
    'X-Frame-Options': string;
    // (undocumented)
    'X-Permitted-Cross-Domain-Policies'?: string;
    // (undocumented)
    'X-XSS-Protection': string;
}

// @public (undocumented)
export interface SecurityMiddlewareOptions extends Omit<CSPOptions, 'nonce'> {
    enableReporting?: boolean;
    headerOverrides?: Record<string, string>;
    isDevelopment?: boolean;
    logViolations?: boolean;
    reportUri?: string;
    skipPaths?: (string | RegExp)[];
}

// @public
export function shouldBypassSecurity(request: NextRequest): boolean;

// @public
export function stripHtml(input: string): string;

// @public (undocumented)
export const submissionRateLimiter: RateLimiter;

// @public
export function useCSRFProtectedFetch(): {
    csrfFetch: (url: string, options?: RequestInit) => Promise<Response>;
    token: string | null;
    loading: boolean;
    error: string | null;
    refreshToken: () => void;
};

// @public
export function useCSRFProtectedForm<T extends Record<string, unknown>>(): {
    submit: (url: string, data: T, options?: {
        method?: "POST" | "PUT" | "PATCH" | "DELETE";
        onSuccess?: (data: unknown) => void;
        onError?: (error: Error) => void;
    }) => Promise<{
        success: boolean;
        error: string;
        data?: never;
    } | {
        success: boolean;
        data: any;
        error?: never;
    }>;
    isSubmitting: boolean;
    submitError: string | null;
    tokenLoading: boolean;
    tokenError: string | null;
};

// @public
export function useCSRFToken(): {
    token: string | null;
    loading: boolean;
    error: string | null;
    refreshToken: () => void;
};

// @public
export function validateContentSecurity(content: string, field: string): void;

// @public
export function validateCSPConfig(options: CSPOptions): {
    isValid: boolean;
    errors: string[];
};

// @public
export function validateCSRFToken(request: NextRequest): Promise<boolean>;

// @public (undocumented)
export const webhookRateLimiter: RateLimiter;

// @public
export function withCSRFProtection<T extends any[]>(handler: (request: NextRequest, ...args: T) => Promise<NextResponse>): (request: NextRequest, ...args: T) => Promise<NextResponse>;

// @public (undocumented)
export function withRateLimit(request: NextRequest, rateLimiter: RateLimiter, handler: () => Promise<NextResponse>): Promise<NextResponse>;

// @public
export function withSecurity(middleware: NextMiddleware, securityOptions?: SecurityMiddlewareOptions): NextMiddleware;

// Warnings were encountered during analysis:
//
// src/rate-limiter.ts:453:5 - (ae-forgotten-export) The symbol "cleanupManager" needs to be exported by the entry point index.d.ts

// (No @packageDocumentation comment for this package)

```
